<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>세종대학교 졸업관리시스템</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/4.4.8/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.4.10/css/AdminLTE.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/iCheck/1.0.2/skins/flat/blue.css">
    <!-- Pace style -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js">
    <!-- izitoast -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Google Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>
<style>
    @import url(http://cdn.rawgit.com/hiun/NanumSquare/master/nanumsquare.css);

    body, div, span, h1, h2, h3, h4 {
        font-family: 'Source Sans Pro', 'Nanum Square';
    }
</style>
<body class="hold-transition login-page">
<div class="login-box">
    <div class="login-logo">
        <a href="/screen/"><b>SEJONG</b>University<br>졸업관리시스템</a>
    </div>
    <!-- /.login-logo -->
    <div class="login-box-body">
        <p class="login-box-msg">서비스를 이용하시려면 로그인하여 주십시오.<br>세종대학교 포털 계정으로 로그인할 수 있습니다.</p>

        <form method="POST" onsubmit="login(); return false;">
            {% csrf_token %}
            <div class="form-group has-feedback">
                <input type="text" class="form-control" name="userId" id="userId" placeholder="학번(아이디)">
                <span class="glyphicon glyphicon-user form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input type="password" class="form-control" name="password" id="password" placeholder="비밀번호">
                <span class="glyphicon glyphicon-lock form-control-feedback"></span>
            </div>
            <div class="row">
                <div class="col-xs-8">
                    <div class="checkbox icheck">
                        <label>
                            <input type="checkbox" disabled> 로그인 기억
                        </label>
                    </div>
                </div>
                <!-- /.col -->
                <div class="col-xs-4">
                    <i class="fa fa-spinner fa-spin fa-2x pull-right" style="display: none" id="spinner"></i>
                    <button type="submit" class="btn btn-primary btn-block btn-flat" id="submit">로그인</button>
                </div>
                <!-- /.col -->
            </div>
        </form>

        <a href="https://portal.sejong.ac.kr/jsp/inquiry/nmconf.jsp">학번(아이디) 찾기</a> /
        <a href="https://portal.sejong.ac.kr/jsp/inquiry/idconf.jsp">비밀번호 찾기</a>

    </div>
    <!-- /.login-box-body -->
</div>
<!-- /.login-box -->

<!-- jQuery 3 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
<!-- iCheck -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/iCheck/1.0.2/icheck.min.js"></script>
<!-- PACE -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js" type="text/javascript"></script>
<!-- izitoast -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' /* optional */
        });
    });

    $(document).ajaxStart(function () {
        Pace.restart()
    });

    var info = "시스템 로그인에 실패하였습니다.";
    var alert00 = "<br>존재하지 않는 학번(아이디)이거나 비밀번호가 틀립니다.";
    var alert01 = "<br>세종대학교 전산과의 공식적인 요청에 따라<br>매학기 수강신청 기간 오전 9시 50분 ~ 10시 10분 사이에는<br>졸업관리시스템 로그인이 불가능합니다.";
    var alert02 = "<br>이번 베타 테스트는<br>졸업대상자(13~15학번)만 가능합니다.";
    var alert03 = "<br>베타 테스트 준비중입니다. 2.13 오픈예정입니다.</br>";

    function login() {
        // $('#submit').css('display', 'none');
        // $('#spinner').css('display', '');

         $.ajax({
             url:'/login/connect/',
             type: 'POST',
             data: {'userId': $('#userId').val(), 'password': $('#password').val()},
             success: function (result) {
                  if (result === 'success') {
                      location.replace("/")
                  } else if (result === "banned") {
                      $('#spinner').css('display', 'none');
                      $('#submit').css('display', '');

                      iziToast.show({
                          title: '알림',
                          message: info + alert01,
                          theme: 'light',
                          color: 'red',
                          position: 'topRight',
                          timeout: 3000
                      })
                  } else if (result === "limited") {
                      $('#spinner').css('display', 'none');
                      $('#submit').css('display', '');

                      iziToast.show({
                          title: '알림',
                          message: info + alert02,
                          theme: 'light',
                          color: 'red',
                          position: 'topRight',
                          timeout: 3000
                      })
                  } else if (result == "close_beta") {
                      $('#spinner').css('display', 'none');
                      $('#submit').css('display', '');

                      iziToast.show({
                          title: '알림',
                          message: info + alert03,
                          theme: 'light',
                          color: 'red',
                          position: 'topRight',
                          timeout: 3000
                      })
                  } else{
                      $('#spinner').css('display', 'none');
                      $('#submit').css('display', '');

                      iziToast.show({
                          title: '알림',
                          message: info + alert00,
                          theme: 'light',
                          color: 'red',
                          position: 'topRight',
                          timeout: 3000
                      })
                  }
             },
             error: function () {
                  $('#spinner').css('display', 'none');
                  $('#submit').css('display', '');

                  iziToast.show({
                      title: '알림',
                      message: info + alert00,
                      theme: 'light',
                      color: 'red',
                      position: 'topRight',
                      timeout: 3000
                  })
             }
         })
    }

    $(document).ajaxSend(function(event, xhr, settings) {
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    function sameOrigin(url) {
        // url could be relative or scheme relative or absolute
        var host = document.location.host; // host + port
        var protocol = document.location.protocol;
        var sr_origin = '//' + host;
        var origin = protocol + sr_origin;
        // Allow absolute or scheme relative URLs to same origin
        return (url == origin || url.slice(0, origin.length + 1) == origin + '/') ||
            (url == sr_origin || url.slice(0, sr_origin.length + 1) == sr_origin + '/') ||
            // or any other URL that isn’t scheme relative or absolute i.e relative.
            !(/^(\/\/|http:|https:).*/.test(url));
    }
    function safeMethod(method) {
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }
    if (!safeMethod(settings.type) && sameOrigin(settings.url)) {
        xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
    }
});
</script>

</body>
</html>